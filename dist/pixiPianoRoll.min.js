!function(r,e){"function"==typeof define&&define.amd?define(["pixi.js","teoria","musical-scale-colors"],e):"object"==typeof exports?module.exports=e(require("pixi.js"),require("teoria"),require("musical-scale-colors")):r.pixiPianoRoll=e(r.PIXI,r.teoria,r.musicalScaleColors)}(this,function(r,e,t){"use strict";function i(i){function o(){var r,t;return i.noteData.forEach(function(i){var n=e.note(i[1]).key();(r>n||"number"!=typeof r)&&(r=n),(n>t||"number"!=typeof t)&&(t=n)}),{min:r-1,max:t}}function a(){m.addChild((new r.Graphics).clear().beginFill(i.backgroundColor).drawRect(0,0,i.width,i.height).endFill())}function l(r){var e=r.split(":"),t=n(e,3),i=t[0],o=t[1],a=void 0===o?0:o,l=t[2],c=void 0===l?0:l;return w*i+x*a+C*c}function c(){var t=!0,o=!1,a=void 0;try{for(var c,u=function(){var t=n(c.value,3),o=t[0],a=t[1],u=t[2],f=i.noteColor,d=new r.Graphics,h=e.note(a),v=l(o)+S,s=i.height-(h.key()-b.min)*q+S,y=w/parseInt(u);"object"==typeof f&&Object.keys(f).forEach(function(r){e.note(r).chroma()===h.chroma()&&(f=f[r])}),p.addChild(d),d.beginFill(f).drawRect(v,s,y,D).endFill()},f=i.noteData[Symbol.iterator]();!(t=(c=f.next()).done);t=!0)u()}catch(d){o=!0,a=d}finally{try{!t&&f["return"]&&f["return"]()}finally{if(o)throw a}}m.addChild(p),p.x=-l(i.time)}function u(r){if("string"!=typeof r)return u("horizontal"),void u("vertical");var e="vertical"===r?z:i.width,t="vertical"===r?i.height:z,n=!0,o=!1,a=void 0;try{for(var l,c=G[r][Symbol.iterator]();!(n=(l=c.next()).done);n=!0){var f=l.value;f.graphic.clear().beginFill(i.gridLineColor).drawRect(f.x,f.y,e,t).endFill()}}catch(d){o=!0,a=d}finally{try{!n&&c["return"]&&c["return"]()}finally{if(o)throw a}}}function f(r){var e=!0,t=!1,i=void 0;try{for(var n,o=G.vertical[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){var a=n.value;a.x=a.x-r}}catch(l){t=!0,i=l}finally{try{!e&&o["return"]&&o["return"]()}finally{if(t)throw i}}if(G.vertical[0].x+z<0){var a=G.vertical.shift();a.x=G.vertical[G.vertical.length-1].x+k,G.vertical.push(a)}}function d(){var e=void 0;for(e=0;g+1>e;e++){var t=new r.Graphics;G.horizontal.push({x:0,y:e*q-S,graphic:t}),m.addChild(t)}for(e=0;e<i.zoom*i.resolution+1;e++){var t=new r.Graphics;G.vertical.push({x:e*k-S,y:0,graphic:t}),m.addChild(t)}}function h(r){v||(v=r);var e=r-v,t=e*F;p.x=p.x-t,f(t),u("vertical"),v=r,y.render(m),s?requestAnimationFrame(h):v=null}i=Object.assign({width:900,height:400,noteColor:t.dDJameson,gridLineColor:3355443,backgroundColor:0,bpm:140,antialias:!0,zoom:4,resolution:2,time:"0:0:0",renderer:"WebGLRenderer",noteData:[]},i);var v=void 0,s=!1,y=new r[i.renderer](i.width,i.height,{antialias:i.antialias}),m=new r.Container,p=new r.Container,b=o(i.noteData),g=b.max-b.min,w=i.width/i.zoom,x=i.width/(4*i.zoom),C=x/4,j=i.bpm/60/1e3,F=x*j,z=w/100,S=z/2,k=w/i.resolution,q=i.height/g,D=q-z,G={horizontal:[],vertical:[]};return a(),d(),u(),c(),y.render(m),Object.defineProperties({play:function(){s=!0,requestAnimationFrame(h)},pause:function(){s=!1}},{playing:{get:function(){return s},configurable:!0,enumerable:!0},view:{get:function(){return y.view},configurable:!0,enumerable:!0}})}var n=function(){function r(r,e){var t=[],i=!0,n=!1,o=void 0;try{for(var a,l=r[Symbol.iterator]();!(i=(a=l.next()).done)&&(t.push(a.value),!e||t.length!==e);i=!0);}catch(c){n=!0,o=c}finally{try{!i&&l["return"]&&l["return"]()}finally{if(n)throw o}}return t}return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return r(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();return i});