!function(r,e){"function"==typeof define&&define.amd?define(["pixi.js","teoria"],e):"object"==typeof exports?module.exports=e(require("pixi.js"),require("teoria")):r.pixiPianoRoll=e(r.PIXI,r.teoria)}(this,function(r,e){"use strict";function t(t){function n(){var r,i;return t.noteData.forEach(function(t){var n=e.note(t[1]).key();(r>n||"number"!=typeof r)&&(r=n),(n>i||"number"!=typeof i)&&(i=n)}),{min:r-1,max:i}}function o(){y.addChild((new r.Graphics).clear().beginFill(t.backgroundColor).drawRect(0,0,t.width,t.height).endFill())}function a(r){var e=r.split(":"),t=i(e,3),n=t[0],o=t[1],a=void 0===o?0:o,l=t[2],c=void 0===l?0:l;return b*n+g*a+F*c}function l(){var n=!0,o=!1,l=void 0;try{for(var c,u=function(){var n=i(c.value,3),o=n[0],l=n[1],u=n[2],d=t.noteColor,f=new r.Graphics,h=e.note(l),v=a(o)+x,s=t.height-(h.key()-p.min)*B+x,y=b/parseInt(u);"object"==typeof d&&Object.keys(d).forEach(function(r){e.note(r).chroma()===h.chroma()&&(d=d[r])}),m.addChild(f),f.beginFill(d).drawRect(v,s,y,E).endFill()},d=t.noteData[Symbol.iterator]();!(n=(c=d.next()).done);n=!0)u()}catch(f){o=!0,l=f}finally{try{!n&&d["return"]&&d["return"]()}finally{if(o)throw l}}y.addChild(m),m.x=-a(t.time)}function c(r){if("string"!=typeof r)return c("horizontal"),void c("vertical");var e="vertical"===r?G:t.width,i="vertical"===r?t.height:G,n=!0,o=!1,a=void 0;try{for(var l,u=j[r][Symbol.iterator]();!(n=(l=u.next()).done);n=!0){var d=l.value;d.graphic.clear().beginFill(t.gridLineColor).drawRect(d.x,d.y,e,i).endFill()}}catch(f){o=!0,a=f}finally{try{!n&&u["return"]&&u["return"]()}finally{if(o)throw a}}}function u(r){var e=!0,t=!1,i=void 0;try{for(var n,o=j.vertical[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){var a=n.value;a.x=a.x-r}}catch(l){t=!0,i=l}finally{try{!e&&o["return"]&&o["return"]()}finally{if(t)throw i}}if(j.vertical[0].x+G<0){var a=j.vertical.shift();a.x=j.vertical[j.vertical.length-1].x+A,j.vertical.push(a)}}function d(){var e=void 0;for(e=0;C+1>e;e++){var i=new r.Graphics;j.horizontal.push({x:0,y:e*B-x,graphic:i}),y.addChild(i)}for(e=0;e<t.zoom*t.resolution+1;e++){var i=new r.Graphics;j.vertical.push({x:e*A-x,y:0,graphic:i}),y.addChild(i)}}function f(r){h||(h=r);var e=r-h,t=e*D;m.x=m.x-t,u(t),c("vertical"),h=r,s.render(y),v?requestAnimationFrame(f):h=null}t=Object.assign({width:900,height:400,noteColor:16713984,gridLineColor:1279,backgroundColor:15856113,bpm:140,antialias:!0,zoom:4,resolution:2,time:"0:0:0",renderer:"WebGLRenderer",noteData:[]},t);var h=void 0,v=!1,s=new r[t.renderer](t.width,t.height,{antialias:t.antialias}),y=new r.Container,m=new r.Container,p=n(t.noteData),C=p.max-p.min,b=t.width/t.zoom,g=t.width/(4*t.zoom),F=g/4,w=t.bpm/60/1e3,D=g*w,G=b/100,x=G/2,A=b/t.resolution,B=t.height/C,E=B-G,j={horizontal:[],vertical:[]};return o(),d(),c(),l(),s.render(y),Object.defineProperties({play:function(){v=!0,requestAnimationFrame(f)},pause:function(){v=!1}},{playing:{get:function(){return v},configurable:!0,enumerable:!0},view:{get:function(){return s.view},configurable:!0,enumerable:!0}})}var i=function(){function r(r,e){var t=[],i=!0,n=!1,o=void 0;try{for(var a,l=r[Symbol.iterator]();!(i=(a=l.next()).done)&&(t.push(a.value),!e||t.length!==e);i=!0);}catch(c){n=!0,o=c}finally{try{!i&&l["return"]&&l["return"]()}finally{if(n)throw o}}return t}return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return r(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();return t.colorscales={louisBertrandCastel:{C:1838466,"C#":1806465,D:1347635,"D#":7377446,E:16118844,F:16110139,"F#":16285712,G:16386828,"G#":10488841,A:14095238,"A#":4918909,B:8325244},dDJameson:{C:16386828,"C#":16008978,D:16285712,"D#":16110139,E:16118844,F:1347635,"F#":1806465,G:1838466,"G#":4918909,A:8325244,"A#":10884486,B:14094981},theodorSeemann:{C:6954012,"C#":16386828,D:16743685,"D#":16569651,E:16118844,F:1478708,"F#":1806465,G:1838466,"G#":8325244,A:14095238,"A#":6954012,B:460551},aWallaceRimington:{C:16386828,"C#":10488841,D:16008978,"D#":16285712,E:16118844,F:7377446,"F#":1347635,G:2532992,"G#":1806465,A:8325244,"A#":1838466,B:14095238},hHelmholtz:{C:16118844,"C#":1347635,D:1806465,"D#":1858464,E:8325244,F:14095238,"F#":10292821,G:16386828,"G#":13839370,A:13839370,"A#":14227793,B:15825423},aScriabin:{C:16386828,"C#":14095238,D:16118844,"D#":5920389,E:1858464,F:10488841,"F#":1838466,G:16285712,"G#":8325756,A:1347635,"A#":5920389,B:1858464},aBernardKlein:{C:12847625,"C#":16386828,D:16008978,"D#":16285712,E:16118844,F:12378169,"F#":1347635,G:1806465,"G#":1838466,A:7870599,"A#":14095238,B:10292821},iJBelmont:{C:16386828,"C#":16008978,D:16285712,"D#":16175377,E:16118844,F:12378169,"F#":1281842,G:1806465,"G#":1838466,A:10818949,"A#":14095238,B:11341384},sZieverink:{C:12378169,"C#":1347635,D:1806465,"D#":1838466,E:8325244,F:14095238,"F#":7277893,G:10488841,"G#":16386828,A:16285712,"A#":15593607,B:16118844}},t});